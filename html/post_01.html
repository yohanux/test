<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>요한 연습</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/color.css">
    <link rel="stylesheet" href="../css/typography.css">
    <link rel="stylesheet" href="../css/comment.css">
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    
</head>
<body>
    <nav class="navbar">
        <a href="../index.html" class="logo__link">
        <div class="navbar__logo">
            <img src="../image/icon-logo.svg" alt="icon" width="24" height="24">
            YOHANUX
        </div>
        </a>
        <div class="navbar__contents">
            <a href="../index.html" class="navbar__item">Post</a>
            <a href="work.html" class="navbar__item">Work</a>
            <a href="https://drive.google.com/file/d/1kUvWxqga7N6lnu7I17FmQMnZOjZmUNRu/view?usp=share_link" target=blank class="navbar__item">Resume</a>
            <a href="about.html" class="navbar__item">About</a>
        </div>
    </nav>
    <div class="post__body">
        <div class="post__contents">
            <div class="post__contents__banner">
                <img src="../image/banner_02.webp" alt="banner">
            </div>
            <div class="post__contents__text">
                <div class="post__contents__text__title">
                    <div class="post__contents__text__title__title">
                        <p class="text-hero-s">애플에 대한 첫인상</p>
                        <p class="text-body-l">시작은 아이팟 셔플로부터</p>
                    </div>
                    <div class="post__contents__text__title__date">
                        <p class="text-body-s">2024. 10. 04</p>
                    </div>
                </div>
                <div class="post__contents__text__body">
                    <p class="text-body-l">
                        때는 2015년,</br>
                        입시를 앞두고 야간자율학습을 하던 고등학교 3학년 때의 일이다.</br></br> 
                        당시 유일하게 사용 가능한 전자기기는 MP3였다.</br>
                        음악을 들으면 능률이 올라갈 것이라는 기대감으로 MP3 구입의 필요성을 느끼던 참이었다.</br></br>
                        그때까지만 해도 안드로이드 찬양론자였던 나에게 애플 제품은 크게 와닿지 않았다.</br>
                        그런데 아이팟 셔플은 디스플레이도 없이 버튼으로만 이루어진 MP3라는 점에서 무척 흥미로웠고 접근 가능했던 가격대 덕분에 구입을 하게 되었다.</br></br>
                        화면을 볼 필요도 없는 500원짜리 동전 크기의 사각형 알루미늄 기계는</br>
                        주머니 안에서 엄지 손가락 하나로 곡을 넘기고, 플레이리스트를 고르고, 셔플 기능까지 제어할 수 있었다.</br></br>
                        나는 처음으로 이 작은 기계에게서 생명력을 느꼈다.</br>
                        이것은 지금까지도 잊혀지지 않는 기억인데 기계가 정말 ‘살아있다’는 인상을 받았다.</br></br>
                        그렇게 한동안 아이튠즈를 사용하며 애플의 하드웨어와 소프트웨어를 모두 경험 했다.</br>
                        그러나 대학 입시가 마무리되면서 자연스레 MP3의 필요성이 떨어졌고 결국 중고 판매를 하게 되었다.</br></br>
                        겨우 동전만 한 그 제품을 구매자에게 건네면서 어딘가 모를 쓸쓸함이 느껴졌다.</br></br>
                        그렇게 많은 시간이 흘러</br>
                        지금의 나는 다양한 애플 제품을 구입하고 사용하며 애플 찬양론자가 되어버렸다.</br></br>
                        어쩌면 그때의 작은 경험이 여기까지 이끌어 준 것은 아닐까.</p>
                </div>
                <div id="comment-root"></div>
            </div>
            
        </div>
    </div>
    <footer>
        <div class="footer__email">
            <img src="../image/icon-mail.svg" alt="icon" width="24" height="24">
            <a href="mailto:yohanux@gmail.com">yohanux@gmail.com</a>
        </div>
        <div class="footer__text">
            <span>© 2025 YOHANUX. All rights reserved.</span>
        </div>
    </footer>
    </div>
    
    <!-- React 및 ReactDOM CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- 댓글 시스템 컴포넌트 -->
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        const CommentSystem = () => {
          const [comments, setComments] = useState([]);
          const [newComment, setNewComment] = useState('');
          const [author, setAuthor] = useState('');
          const [isAdmin, setIsAdmin] = useState(false);
          const [adminPassword, setAdminPassword] = useState('');
          const [showAdminLogin, setShowAdminLogin] = useState(false);

          // 로컬 스토리지에서 댓글 불러오기
          useEffect(() => {
            const savedComments = localStorage.getItem('comments');
            if (savedComments) {
              setComments(JSON.parse(savedComments));
            }
            
            // 관리자 상태 확인
            const adminStatus = localStorage.getItem('isAdmin');
            if (adminStatus === 'true') {
              setIsAdmin(true);
            }
          }, []);

          // textarea 초기 높이 설정
          useEffect(() => {
            const textarea = document.querySelector('.comment-input');
            if (textarea) {
              // 초기 높이를 2줄 텍스트 높이로 설정
              textarea.style.height = '4.5em';
            }
          }, []);

          // 댓글 저장
          const saveComments = (newComments) => {
            localStorage.setItem('comments', JSON.stringify(newComments));
            setComments(newComments);
          };

          // textarea 자동 높이 조절
          const adjustTextareaHeight = (element) => {
            element.style.height = 'auto';
            const scrollHeight = element.scrollHeight;
            // 최소 높이를 2줄 텍스트 높이로 설정
            const minHeight = 4.5 * 16; // 4.5em * 16px (기본 폰트 크기)
            element.style.height = Math.max(scrollHeight, minHeight) + 'px';
          };

          // 댓글 추가
          const addComment = () => {
            if (!newComment.trim() || !author.trim()) {
              alert('댓글과 작성자를 입력해주세요.');
              return;
            }

            const comment = {
              id: Date.now(),
              text: newComment,
              author: author,
              date: new Date().toLocaleString('ko-KR'),
              isUserComment: true
            };

            const updatedComments = [...comments, comment];
            saveComments(updatedComments);
            setNewComment('');
            
            // textarea 높이를 기본값으로 초기화
            const textarea = document.querySelector('.comment-input');
            if (textarea) {
              textarea.style.height = '4.5em';
            }
          };

          // 사용자 댓글 삭제
          const deleteUserComment = (commentId) => {
            const updatedComments = comments.filter(comment => comment.id !== commentId);
            saveComments(updatedComments);
          };

          // 관리자 로그인
          const handleAdminLogin = () => {
            if (adminPassword === 'admin123') { // 실제 운영시에는 더 안전한 방법 사용
              setIsAdmin(true);
              localStorage.setItem('isAdmin', 'true');
              setShowAdminLogin(false);
              setAdminPassword('');
              alert('관리자로 로그인되었습니다.');
            } else {
              alert('비밀번호가 올바르지 않습니다.');
            }
          };

          // 관리자 로그아웃
          const handleAdminLogout = () => {
            setIsAdmin(false);
            localStorage.removeItem('isAdmin');
            alert('로그아웃되었습니다.');
          };

          // 관리자 댓글 삭제
          const deleteCommentAsAdmin = (commentId) => {
            const updatedComments = comments.filter(comment => comment.id !== commentId);
            saveComments(updatedComments);
          };

          // 모든 댓글 삭제 (관리자 전용)
          const deleteAllComments = () => {
            if (window.confirm('모든 댓글을 삭제하시겠습니까?')) {
              saveComments([]);
              alert('모든 댓글이 삭제되었습니다.');
            }
          };

          return (
            <div className="comment-system">
              <div className="comment-header">
                <h3>댓글 ({comments.length})</h3>
                {isAdmin && (
                  <div className="admin-controls">
                    <button 
                      className="admin-btn delete-all-btn"
                      onClick={deleteAllComments}
                    >
                      모든 댓글 삭제
                    </button>
                    <button 
                      className="admin-btn logout-btn"
                      onClick={handleAdminLogout}
                    >
                      로그아웃
                    </button>
                  </div>
                )}
                {!isAdmin && (
                  <button 
                    className="admin-login-btn"
                    onClick={() => setShowAdminLogin(true)}
                  >
                    관리자
                  </button>
                )}
              </div>

              {/* 관리자 로그인 모달 */}
              {showAdminLogin && (
                <div className="admin-login-modal">
                  <div className="modal-content">
                    <h4>관리자 로그인</h4>
                    <input
                      type="password"
                      placeholder="비밀번호를 입력하세요"
                      value={adminPassword}
                      onChange={(e) => setAdminPassword(e.target.value)}
                      onKeyPress={(e) => e.key === 'Enter' && handleAdminLogin()}
                    />
                    <div className="modal-buttons">
                      <button onClick={handleAdminLogin}>로그인</button>
                      <button onClick={() => setShowAdminLogin(false)}>취소</button>
                    </div>
                  </div>
                </div>
              )}

              {/* 댓글 작성 폼 */}
              <div className="comment-form">
                <div className="form-row">
                  <input
                    type="text"
                    placeholder="작성자"
                    value={author}
                    onChange={(e) => setAuthor(e.target.value)}
                    className="author-input"
                  />
                </div>
                <div className="form-row">
                  <textarea
                    placeholder="댓글을 입력하세요..."
                    value={newComment}
                    onChange={(e) => {
                      setNewComment(e.target.value);
                      adjustTextareaHeight(e.target);
                    }}
                    className="comment-input"
                  />
                </div>
                <button 
                  onClick={addComment} 
                  className="submit-btn"
                  disabled={!newComment.trim() || !author.trim()}
                >
                  댓글 작성
                </button>
              </div>

              {/* 댓글 목록 */}
              <div className="comments-list">
                {comments.map(comment => (
                  <div key={comment.id} className="comment-item">
                    <div className="comment-header">
                      <span className="comment-author">{comment.author}</span>
                      <span className="comment-date">{comment.date}</span>
                    </div>
                    <div className="comment-text">{comment.text}</div>
                                          <div className="comment-actions">
                        {isAdmin && (
                          <>
                            <button 
                              onClick={() => deleteCommentAsAdmin(comment.id)}
                              className="admin-delete-btn"
                            >
                              관리자 삭제
                            </button>
                          </>
                        )}
                      </div>
                  </div>
                ))}
              </div>
            </div>
          );
        };

        // React 앱 렌더링
        const root = ReactDOM.createRoot(document.getElementById('comment-root'));
        root.render(<CommentSystem />);
    </script>
</body>
</html>